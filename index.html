<html>
<head>
<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
</head>
<body>
<div class="container">
<h1>Python Serialization Benchmark</h1>
<p>This <a href="http://github.com/voidfiles/python-serialization-benchmark">repository</a> maintains a set of benchmarks for python serialization frameworks.</p>
<p>You can find the latest benchmarks on <a href="https://voidfiles.github.io/python-serialization-benchmark/">this page</a>.</p>
<p>Currently the following projects are benchmarked.</p>
<ul>
<li><a href="http://www.django-rest-framework.org/">Django REST framework</a></li>
<li><a href="http://serpy.readthedocs.io/">serpy</a></li>
<li><a href="https://marshmallow.readthedocs.io/en/latest/">Marshmallow</a></li>
<li><a href="https://github.com/voidfiles/strainer">Strainer</a></li>
<li><a href="http://lollipop.readthedocs.io/en/latest/">Lollipop</a></li>
<li><a href="http://kim.readthedocs.io/en/latest/">kim</a></li>
</ul>
<p>Along with a baseline custom function that doesn't use a framework.</p>
<h2>Running the test suite</h2>
<p>A Docker container is bundled with the repository which you can use to run the benchmarks. Firstly make sure you have Docker installed.</p>
<ol>
<li>
<p>Install Docker</p>
</li>
<li>
<p>Build the container <code>$ docker-compose build</code></p>
</li>
<li>
<p>Run the tests. <code>$ docker-compose run --rm tests</code></p>
</li>
</ol>
<pre><code>Library                  Many Objects (seconds)    One Object (seconds)    Relative
---------------------  ------------------------  ----------------------  ----------
Custom                                0.015099               0.00744438     1
lima                                  0.0184031              0.00941515     1.23398
serpy                                 0.0564134              0.0302956      3.84631
Strainer                              0.0645332              0.0326135      4.30932
Lollipop                              0.572213               0.275513      37.6042
Marshmallow                           0.955579               0.494589      64.3277
kim                                   1.10544                0.548943      73.3867
Django REST Framework                 1.38124                0.979011     104.698
</code></pre>

<h2>The Benchmark</h2>
<p>Each framework is asked to serialize a list of 2 objects a 1000 times, and then 1 object a 1000 times.</p>
<p>This is the current object that is being serialized.</p>
<pre><code class="python">class ChildTestObject(object):
    def __init__(self, multiplier=None):
        self.w = 1000 * multiplier if multiplier else 100
        self.x = 20 * multiplier if multiplier else 20
        self.y = 'hello' * multiplier if multiplier else 'hello'
        self.z = 10 * multiplier if multiplier else 10


class ParentTestObject(object):
    def __init__(self):
        self.foo = 'bar'
        self.sub = ChildTestObject()
        self.subs = [ChildTestObject(i) for i in xrange(10)]

    def bar(self):
        return 5

benchmark_object = ParentTestObject()
</code></pre>

<h2>Discussion</h2>
<p>Serialization from python objects to JSON, XML, or other transmission formats is a common task for many web related projects. In order to fill that need a number of frameworks have arised. While their aims are similar, they don't all share the same attributes. Here are how some of the features comapre.</p>
<table class="table">
  <thead>
    <tr>
        <td>Project</td>
        <td>Serialization</td>
        <td>Encoding</td>
        <td>Deserialization</td>
        <td>Validation</td>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><a href="http://www.django-rest-framework.org/">Django REST Framework</a></td>
      <td><a href="http://www.django-rest-framework.org/api-guide/serializers/">Yes</a></td>
      <td><a href="http://www.django-rest-framework.org/api-guide/renderers/">Yes</a></td>
      <td><a href="http://www.django-rest-framework.org/api-guide/validators/">Yes</a></td>
      <td><a href="http://www.django-rest-framework.org/api-guide/validators/">Yes</a></td>
    </tr>
    <tr>
      <td><a href="http://serpy.readthedocs.io/">serpy</a></td>
      <td><a href="http://serpy.readthedocs.io/en/latest/#examples">Yes</a></td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
    </tr>
    <tr>
      <td><a href="https://marshmallow.readthedocs.io/en/latest/">marshmallow</a></td>
      <td><a href="https://marshmallow.readthedocs.io/en/latest/quickstart.html#serializing-objects-dumping">Yes</a></td>
      <td><a href="https://marshmallow.readthedocs.io/en/latest/quickstart.html#serializing-objects-dumping">Yes</a></td>
      <td><a href="https://marshmallow.readthedocs.io/en/latest/quickstart.html#deserializing-objects-loading">Yes</a></td>
      <td><a href="https://marshmallow.readthedocs.io/en/latest/quickstart.html#validation">Yes</a></td>
    </tr>
    <tr>
      <td><a href="https://github.com/maximkulkin/lollipop">Lollipop</a></td>
      <td><a href="http://lollipop.readthedocs.io/en/latest/quickstart.html#serializing-data">Yes</a></td>
      <td>No</td>
      <td><a href="http://lollipop.readthedocs.io/en/latest/quickstart.html#deserializing-data">Yes</a></td>
      <td><a href="http://lollipop.readthedocs.io/en/latest/quickstart.html#validation">Yes</a></td>
    </tr>
    <tr>
      <td><a href="https://github.com/voidfiles/strainer">strainer</a></td>
      <td><a href="https://github.com/voidfiles/strainer#serialization-example">Yes</a></td>
      <td><a href="https://github.com/voidfiles/strainer/blob/master/strainer/encoders.py#L25">Yes</a></td>
      <td><a href="https://github.com/voidfiles/strainer#validation">Yes</a></td>
      <td><a href="https://github.com/voidfiles/strainer#validation">Yes</a></td>
    </tr>
    <tr>
      <td><a href="http://kim.readthedocs.io/en/latest/">kim</a></td>
      <td><a href="http://kim.readthedocs.io/en/latest/user/quickstart.html#serializing-data">Yes</a></td>
      <td>No</td>
      <td><a href="http://kim.readthedocs.io/en/latest/user/quickstart.html#marshaling-data">Yes</a></td>
      <td><a href="http://kim.readthedocs.io/en/latest/user/quickstart.html#handling-validation-errors">Yes</a></td>
    </tr>
  </tbody>
</table>

<ul>
<li><strong>Serialization</strong>: Does the framework provide a way of serializing python objects to simple datastructures</li>
<li><strong>Encoding</strong>: Does the framework provide a way of encoding data into a wire format</li>
<li><strong>Deserialization</strong>: Does the framework provide a way of deserializing simple data structures into complex data structures</li>
<li><strong>Validation</strong>: Does the framework provide a way of validating datastructures, and reprorting error conditions</li>
<li><strong>Part of Framework</strong>: Is serialization apart of a larger framework</li>
</ul></div>
</body>
</html>
